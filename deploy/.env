DEBUG = true
#================= PostgreSQL 設定 (資料庫) =================
DB_NAME=lifelog
DB_SUPERUSER=postgres
DB_SUPERPASS=SQwqeJRTui-tejioED43G-YJ73GE3HIJ
DB_HOST=postgres
DB_PORT=5432
DB_PORT_PUBLIC=30700

# ================= API Server 設定 =================
# 權限設定
JWT_SECRET_KEY=pokiuytdru7fgt90ewuhy783u82uhdliewhduip23ugp
JWT_EXPIRE_MINUTES = 1440  # 1 day
# 
# 內網 API Server 位置
API_BASE_URL=http://api:30000

# Broker
BROKER_URL=redis://redis:6379/0

# Celery Result Backend
CELERY_RESULT_BACKEND=redis://redis:6379/1

# Eager 模式（本機單步、無需 Redis/worker）
CELERY_TASK_ALWAYS_EAGER=false

# Celery
CELERY_TASK_SERIALIZER=json
CELERY_ACCEPT_CONTENT=json
CELERY_RESULT_SERIALIZER=json
CELERY_TIME_LIMIT=1200        # 硬超時（秒）
CELERY_SOFT_TIME_LIMIT=1100   # 軟超時（秒）
CELERY_WORKER_CONCURRENCY=2
CELERY_PREFETCH_MULTIPLIER=1
CELERY_ACKS_LATE=true
CELERY_VISIBILITY_TIMEOUT=1220


# ================= 公開網域配置（用於生成外部訪問 URL）=================
# 每個服務可以獨立設定，支援 IP 或域名
# 如果設為空字串，系統會嘗試從 Request Host header 自動偵測
# 範例：192.168.191.20 或 https://app.lifelog.ai

# API Server 公開網域（用於生成 API URL）
API_PUBLIC_DOMAIN=192.168.191.20
API_PUBLIC_SCHEME=http
API_PUBLIC_PORT=80

# WebUI Server 公開網域（用於生成前端 URL）
WEBUI_PUBLIC_DOMAIN=192.168.191.20
WEBUI_PUBLIC_SCHEME=http
WEBUI_PUBLIC_PORT=80

# MediaMTX RTSP 公開網域（用於生成 RTSP 推流 URL）
# 注意：RTSP 必須使用獨立 TCP 端口，無法通過 HTTP 路徑代理
RTSP_PUBLIC_DOMAIN=192.168.191.20
RTSP_PUBLIC_SCHEME=rtsp
RTSP_PUBLIC_PORT=8554

# MediaMTX HLS 公開網域（用於生成 HLS 播放 URL）
HLS_PUBLIC_DOMAIN=192.168.191.20
HLS_PUBLIC_SCHEME=http
HLS_PUBLIC_PORT=80

# MediaMTX WebRTC 公開網域（用於生成 WebRTC 播放 URL）
WEBRTC_PUBLIC_DOMAIN=192.168.191.20
WEBRTC_PUBLIC_SCHEME=http
WEBRTC_PUBLIC_PORT=80

# MinIO 公開網域（用於生成預簽章 URL）
# 注意：presigned URLs 無法通過 Nginx 代理，因為簽名是基於完整路徑的
# 因此，MinIO 需要使用直接端口（30300）作為公開端點
MINIO_PUBLIC_DOMAIN=192.168.191.20
MINIO_PUBLIC_SCHEME=http
MINIO_PUBLIC_PORT=30300
MINIO_DIRECT_PORT=30300  # MinIO 直接暴露的端口（用於 presigned URLs）

# ================= CORS 設定 =================
# WebUI Server CORS 允許的來源（用逗號分隔多個來源）
# 如果設為 "*"，允許所有來源（開發環境）
# 生產環境建議設定具體的域名或 IP
CORS_ORIGINS=*

# ================= MinIO 設定 ================= 
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=MinIOPASSwoRd_Str0nG
MINIO_ENDPOINT=http://minio:9000
MINIO_BUCKET=media-bucket
PRESIGN_EXPIRES=3600

# ================= Streaming Server ================= 

# MediaMTX RTSP 基礎 URL（用於 Docker 網絡內通信，使用容器內部端口 8554）
# 注意：外部推流端應使用外部端口 30201，但 StreamingServer 在 Docker 網絡內應使用內部端口 8554
# 外網對外網：外部推流端使用 rtsp://localhost:30201
# 內網對內網：StreamingServer 使用 rtsp://mediamtx:8554
MEDIAMTX_RTSP_BASE=rtsp://mediamtx:8554
SEGMENT_SECONDS=60
ALIGN_FIRST_CUT=true
RECORD_ROOT=/recordings
LOG_DIR=/var/log/streaming
STREAMING_BASE=http://streaming:30500
INTERNAL_TOKEN=streaming-01990207-2ca6-7c62-b441-89e75a6e094c


JOB_API_BASE=http://api:30000/api/v1
# 跟 API Server 溝通的 API Key，需要由管理員產生
JOB_API_KEY=78gKSEhxXLmQqepclQOLWJssQtMSZa9PchBikri-BTWJ6KP8l36_G0O23OR3Fm6p

# RTSP 設定（保留向後兼容，但建議使用上面的 RTSP_PUBLIC_DOMAIN）
RTSP_PUBLIC_HOST=192.168.191.20
RTSP_PORT=8554
STREAM_JWT_SECRET = streaming-01496201-2216-7562-b941-89e7ea6e094c
STREAM_JWT_ALG = HS256
STREAM_TOKEN_TTL_SECONDS = 1800
STREAM_TOKEN_CLOCK_SKEW = 60
STREAM_PUBLISH_TTL = 60
STREAM_PLAY_TTL = 300
# 可選：開啟 SQLite outbox（指定一個 volume 內的路徑）
# UPLOADER_DB=/data/uploader.db

# HLS 設定（保留向後兼容，但建議使用上面的 HLS_PUBLIC_DOMAIN）
HLS_PUBLIC_HOST=192.168.191.20
HLS_PORT=80

# WebRTC 設定（保留向後兼容，但建議使用上面的 WEBRTC_PUBLIC_DOMAIN）
WEBRTC_PUBLIC_HOST=192.168.191.20
WEBRTC_PORT=80
WEBRTC_SCHEME=http