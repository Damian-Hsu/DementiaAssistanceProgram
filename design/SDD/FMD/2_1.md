# 2-1 首頁

- **功能編號**：2-1
- **功能名稱**：首頁
- **功能說明**：首頁提供以日期為核心的「今日日記 + 當日 Vlog」整合視圖：使用者可切換日期後查看該日的日記摘要與 Vlog 狀態；日記可手動刷新並可依事件變化自動刷新；Vlog 可查看進度、播放完成影片、生成新 Vlog 或刪除既有 Vlog。
- **程式名稱**：services/WebUIServer/app/template/home.html; services/WebUIServer/app/static/js/home.js; services/WebUIServer/app/static/js/diary.js; services/WebUIServer/app/static/js/vlog.js; services/WebUIServer/app/static/js/APIClient.js; services/APIServer/app/router/Chat/service.py; services/APIServer/app/router/Vlogs/service.py
- **輸入**：系統、滑鼠、鍵盤；首頁介面、日記介面、Vlog介面、diary資料表、events資料表、vlogs資料表
- **輸出**：螢幕、資料庫；首頁介面、日記介面、Vlog介面、diary資料表、vlogs資料表

## INPUT / PROCESS / OUTPUT

| INPUT | PROCESS | OUTPUT |
|---|---|---|
| ❶ 系統載入首頁介面 | ❶ 取得目標日期並載入該日日記與 Vlog 資料。 | ❶ 顯示當日日記內容與 Vlog 狀態 |
| ❷ 滑鼠點選日期切換 | ❷ 更新目標日期並重新載入該日日記與 Vlog 資料。 | ❷ 更新日期顯示並顯示該日內容 |
| ❸ 滑鼠點選【刷新日記】 | ❸ 送出日記生成/刷新請求並寫入 diary 資料表。 | ❸ 更新日記內容 |
| ❹ 滑鼠點選【生成Vlog】 |  | ❹ 跳出事件選擇介面 |
| ❺ 滑鼠點選【刪除Vlog】<br>&nbsp;&nbsp;① 【取消】<br>&nbsp;&nbsp;② 【確認】 |  | ❺ 跳出刪除確認視窗 |
| ❺-① 滑鼠點選【取消】 |  | ❺-① 關閉刪除確認視窗 |
| ❺-② 滑鼠點選【確認】 | ❺-② 刪除 vlogs 資料表記錄並同步移除相關資源。 | ❺-② 刪除 Vlog 記錄 |

## 資料表

### users; diary; events; vlogs; vlog_segments; inference_jobs; music

| 欄位 | 中文 | 型態 | 長度 | 空值 | 預設值 | 備註 |
|---|---|---|---:|---|---|---|
| settings | 使用者設定 | JSONB |  | 是 |  | users.settings（timezone/diary_auto_refresh_interval_minutes/LLM 等） |
| diary_date | 日記日期 | DATE |  | 否 |  | diary.diary_date |
| content | 日記內容 | TEXT |  | 是 |  | diary.content |
| start_time | 事件開始時間 | TIMESTAMP WITH TIME ZONE |  | 是 |  | events.start_time |
| status | Vlog 狀態 | VARCHAR | 50 | 否 | pending | vlogs.status |
