# 2-1-4 顯示當日 Vlog

- **功能編號**：2-1-4
- **功能名稱**：顯示當日 Vlog
- **功能說明**：首頁會依目前選擇日期載入該日最新 Vlog（若存在），並顯示其狀態、進度、訊息與影片/縮圖；當 Vlog 完成後可取得縮圖與播放 URL 進行預覽，若處理中則顯示 spinner 與進度條並定期輪詢更新狀態。
- **程式名稱**：services/WebUIServer/app/template/home.html; services/WebUIServer/app/static/js/vlog.js; services/WebUIServer/app/static/js/APIClient.js; services/APIServer/app/router/Vlogs/service.py; services/APIServer/app/DataAccess/tables/vlogs.py; services/APIServer/app/DataAccess/tables/inference_jobs.py
- **輸入**：系統；Vlog介面、vlogs資料表
- **輸出**：螢幕；Vlog介面

## INPUT / PROCESS / OUTPUT

| INPUT | PROCESS | OUTPUT |
|---|---|---|
| ❶ 系統載入Vlog介面 | ❶ 依目標日期查詢 vlogs 狀態；若處理中則輪詢更新，完成後取得縮圖與影片連結。 | ❶ 顯示Vlog狀態、進度與預覽 |

## 資料表

### vlogs; inference_jobs

| 欄位 | 中文 | 型態 | 長度 | 空值 | 預設值 | 備註 |
|---|---|---|---:|---|---|---|
| id | VlogID | UUID |  | 否 | uuid7 | vlogs.id；Primary Key |
| user_id | 使用者ID | INTEGER |  | 否 |  | vlogs.user_id；ForeignKey(users.id)；索引 |
| target_date | 目標日期 | DATE |  | 否 |  | vlogs.target_date |
| status | 狀態 | VARCHAR | 50 | 否 | pending | vlogs.status（pending/processing/completed/failed） |
| progress | 進度 | FLOAT |  | 否 | 0.0 | vlogs.progress（0~100） |
| status_message | 狀態訊息 | TEXT |  | 是 |  | vlogs.status_message |
| s3_key | 影片S3路徑 | TEXT |  | 是 |  | vlogs.s3_key |
| thumbnail_s3_key | 縮圖S3路徑 | TEXT |  | 是 |  | vlogs.thumbnail_s3_key |
| duration | 影片長度 | FLOAT |  | 是 |  | vlogs.duration |
| settings | 設定 | JSONB |  | 是 |  | vlogs.settings（含 job_id/error_message 等） |
| created_at | 建立時間(UTC) | TIMESTAMP WITH TIME ZONE |  | 否 | timezone('UTC', now()) | vlogs.created_at；TimestampMixin |
| updated_at | 更新時間(UTC) | TIMESTAMP WITH TIME ZONE |  | 是 |  | vlogs.updated_at；TimestampMixin；更新時由資料庫 onupdate |
