{
  "功能編號": "1-1-1",
  "功能名稱": "登入",
  "功能說明": "使用者於登入頁面輸入帳號與密碼送出後，由後端驗證帳號/密碼與帳號啟用狀態，成功則簽發 JWT 存取權杖並回傳；前端收到權杖後寫入 localStorage，並取得目前使用者角色後導向一般使用者首頁或管理員任務頁。",
  "程式名稱": "services/WebUIServer/app/template/auth.html; services/WebUIServer/app/static/js/sign_login.js; services/WebUIServer/app/static/js/APIClient.js; services/WebUIServer/app/static/js/AuthService.js; services/APIServer/app/router/Authentication/service.py; services/APIServer/app/router/User/service.py; services/APIServer/app/security/jwt_manager.py",
  "輸入摘要": {
    "觸發名詞": [
      "鍵盤",
      "滑鼠"
    ],
    "資源名詞": [
      "登入/註冊介面",
      "users資料表"
    ]
  },
  "輸出摘要": {
    "觸發名詞": [
      "螢幕"
    ],
    "資源名詞": [
      "登入/註冊介面",
      "首頁",
      "管理員任務管理介面"
    ]
  },
  "步驟表": [
    {
      "step_no": "❶",
      "INPUT": {
        "required": true,
        "trigger": "鍵盤",
        "verb": "輸入",
        "objects": [
          "【帳號】",
          "【密碼】"
        ],
        "text": "鍵盤輸入【帳號】、【密碼】",
        "sub_steps": [
          {
            "sub_no": "①",
            "text": "【帳號】"
          },
          {
            "sub_no": "②",
            "text": "【密碼】"
          }
        ]
      },
      "PROCESS": {
        "present": true,
        "text": "前端檢查帳號格式（6~30 字元、僅允許英數字與 ._、不可含空白）",
        "sub_steps": []
      },
      "OUTPUT": {
        "present": true,
        "trigger": "螢幕",
        "verb": "更新",
        "objects": [
          "輸入框提示狀態"
        ],
        "text": "不合法：改變輸入框顏色為紅色",
        "sub_steps": []
      }
    },
    {
      "step_no": "❷",
      "INPUT": {
        "required": true,
        "trigger": "滑鼠",
        "verb": "點選",
        "objects": [
          "【Log in】"
        ],
        "text": "滑鼠點選【Log in】",
        "sub_steps": []
      },
      "PROCESS": {
        "present": true,
        "text": "前端檢查是否不合法（同上）；否則送出帳號密碼，後端先進行欄位驗證，再與 users 資料表驗證對應帳密，正確後獲取身分，錯誤則返回「帳號或密碼錯誤」。",
        "sub_steps": [
          {
            "sub_no": "①",
            "text": "是：提示使用者錯誤"
          },
          {
            "sub_no": "②",
            "text": "否：送出登入請求並驗證帳密與帳號狀態"
          }
        ]
      },
      "OUTPUT": {
        "present": true,
        "trigger": "螢幕",
        "verb": "顯示",
        "objects": [
          "登入結果"
        ],
        "text": "登入成功：進入一般使用者首頁或管理員任務管理介面；登入失敗：顯示錯誤訊息",
        "sub_steps": []
      }
    }
  ],
  "資料表": {
    "table_name": "users",
    "columns": [
      {
        "欄位": "id",
        "中文": "使用者ID",
        "型態": "INTEGER",
        "長度": null,
        "空值": "否",
        "預設值": "autoincrement",
        "備註": "Primary Key"
      },
      {
        "欄位": "account",
        "中文": "帳號",
        "型態": "VARCHAR",
        "長度": 50,
        "空值": "否",
        "預設值": null,
        "備註": "唯一；索引"
      },
      {
        "欄位": "name",
        "中文": "姓名",
        "型態": "VARCHAR",
        "長度": 100,
        "空值": "否",
        "預設值": null,
        "備註": null
      },
      {
        "欄位": "role",
        "中文": "角色",
        "型態": "ENUM",
        "長度": null,
        "空值": "否",
        "預設值": "user",
        "備註": "RoleEnum（user/admin）"
      },
      {
        "欄位": "gender",
        "中文": "性別",
        "型態": "ENUM",
        "長度": null,
        "空值": "否",
        "預設值": null,
        "備註": "GenderEnum"
      },
      {
        "欄位": "birthday",
        "中文": "生日",
        "型態": "DATE",
        "長度": null,
        "空值": "否",
        "預設值": null,
        "備註": null
      },
      {
        "欄位": "phone",
        "中文": "手機號碼",
        "型態": "VARCHAR",
        "長度": 20,
        "空值": "否",
        "預設值": null,
        "備註": "唯一；索引"
      },
      {
        "欄位": "email",
        "中文": "電子郵件",
        "型態": "VARCHAR",
        "長度": 100,
        "空值": "否",
        "預設值": null,
        "備註": "唯一；索引"
      },
      {
        "欄位": "headshot_url",
        "中文": "頭像URL",
        "型態": "TEXT",
        "長度": null,
        "空值": "是",
        "預設值": null,
        "備註": null
      },
      {
        "欄位": "password_hash",
        "中文": "密碼雜湊",
        "型態": "VARCHAR",
        "長度": 256,
        "空值": "否",
        "預設值": null,
        "備註": "bcrypt hash"
      },
      {
        "欄位": "active",
        "中文": "帳號啟用狀態",
        "型態": "BOOLEAN",
        "長度": null,
        "空值": "否",
        "預設值": true,
        "備註": null
      },
      {
        "欄位": "settings",
        "中文": "使用者設定",
        "型態": "JSONB",
        "長度": null,
        "空值": "是",
        "預設值": null,
        "備註": null
      },
      {
        "欄位": "created_at",
        "中文": "建立時間(UTC)",
        "型態": "TIMESTAMP WITH TIME ZONE",
        "長度": null,
        "空值": "否",
        "預設值": "timezone('UTC', now())",
        "備註": "TimestampMixin"
      },
      {
        "欄位": "updated_at",
        "中文": "更新時間(UTC)",
        "型態": "TIMESTAMP WITH TIME ZONE",
        "長度": null,
        "空值": "是",
        "預設值": null,
        "備註": "TimestampMixin；更新時由資料庫 onupdate"
      }
    ]
  }
  ,
  "備註": "使用JWT權杖簽發。"
}
