# 2-4-1 事件列表查詢

# Mermaid
```mermaid
sequenceDiagram
  actor User
  participant Browser
  participant WebUIServer
  participant APIServer
  participant Postgres

  User ->> Browser: 輸入【關鍵字】與【日期範圍】\n點選【篩選】
  Browser ->> WebUIServer: GET /bff/v1/events/?q={kw}&start_time={d1}&end_time={d2}&sort=start_time:desc&page=1&size=20\nAuthorization: Bearer jwt
  WebUIServer ->> APIServer: GET /api/v1/events/?...
  APIServer ->> Postgres: SELECT events\nWHERE user_id=current_user\nAND start_time in range\nAND (summary/action/scene ILIKE %kw%)（視實作）
  Postgres -->> APIServer: events[] + total
  APIServer -->> WebUIServer: 200 {items,total}
  WebUIServer -->> Browser: 200 ...

  alt 無資料
    Browser ->> Browser: 顯示「無事件」提示
  else 有資料
    Browser ->> Browser: 渲染事件列表\n支援分頁/排序
  end
```

## Mermaid 備註
- API：前端使用 `GET /bff/v1/events/`，透過 query string 帶入關鍵字、日期範圍、排序與分頁。\n- 缺少的關鍵資訊：後端 Events router 的 query 參數命名（`q/keywords`）與搜尋欄位範圍需以 `Events/service.py` 為準；本圖以 `q/start_time/end_time/sort` 抽象表示。\n+

