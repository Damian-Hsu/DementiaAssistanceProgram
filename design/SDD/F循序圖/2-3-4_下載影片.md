# 2-3-4 下載影片

# Mermaid
```mermaid
sequenceDiagram
  actor User
  participant Browser
  participant WebUIServer
  participant APIServer
  participant Minio

  User ->> Browser: 點選【下載】
  Browser ->> WebUIServer: GET /bff/v1/recordings/{recordingId}?ttl=1800&disposition=attachment&filename=video.mp4\nAuthorization: Bearer jwt
  WebUIServer ->> APIServer: GET /api/v1/recordings/{recordingId}?...

  alt 錄影不存在/無權限
    APIServer -->> WebUIServer: 403/404
    WebUIServer -->> Browser: 403/404
    Browser ->> Browser: 顯示錯誤
  else 成功
    APIServer ->> Minio: generate presigned GET URL\n(content-disposition=attachment)
    Minio -->> APIServer: presigned_url
    APIServer -->> WebUIServer: 200 {url}
    WebUIServer -->> Browser: 200 {url}
    Browser ->> Browser: window.location.href = url\n觸發下載
  end
```

## Mermaid 備註
- 下載同樣使用 `GET /recordings/{id}`，差別在 `disposition=attachment` 與可選的 `filename`。\n- 缺少的關鍵資訊：前端實際以 `<a download>` 或 `window.open()` 觸發下載，屬 UI 實作差異；本圖以 `location.href` 抽象表示。\n+

