{
  "功能編號": "2-6-5",
  "功能名稱": "串流連結TTL 設定",
  "功能說明": "使用者可設定相機串流連結的預設有效時間（TTL，秒）。前端載入時從 GET /users/settings 取得 default_stream_ttl，若未設定則使用預設 300 秒；儲存後以 PATCH /users/settings 更新 users.settings.default_stream_ttl（範圍 300-21600 秒）。後端 Camera/Streaming 相關端點會讀取此 TTL 作為推流連結或串流連線的有效時間設定。",
  "程式名稱": "services/WebUIServer/app/template/user_profile.html; services/WebUIServer/app/static/js/user_profile.js; services/WebUIServer/app/static/js/APIClient.js; services/APIServer/app/router/User/service.py; services/APIServer/app/router/User/settings.py; services/APIServer/app/router/Camera/service.py; services/APIServer/app/DataAccess/tables/users.py",
  "輸入": [
    "default_stream_ttl（300-21600）",
    "Bearer JWT"
  ],
  "輸出": [
    "UserSettingsResponse.settings.default_stream_ttl",
    "成功/失敗提示訊息",
    "後續相機串流連結有效時間套用"
  ],
  "INPUT_PROCESS_OUTPUT": {
    "INPUT": [
      {
        "step_no": 1,
        "title": "頁面載入",
        "sub_steps": [
          {
            "sub_no": "①",
            "item": "呼叫 GET /users/settings 取得 default_stream_ttl"
          },
          {
            "sub_no": "②",
            "item": "若未設定則顯示預設 300 秒"
          }
        ]
      },
      {
        "step_no": 2,
        "title": "鍵盤輸入",
        "sub_steps": [
          {
            "sub_no": "①",
            "item": "輸入串流連結 TTL（秒）"
          }
        ]
      },
      {
        "step_no": 3,
        "title": "滑鼠點選",
        "sub_steps": [
          {
            "sub_no": "①",
            "item": "點擊【儲存應用程式設定】"
          }
        ]
      }
    ],
    "PROCESS": [
      {
        "step_no": 1,
        "title": "資料寫入",
        "sub_steps": [
          {
            "sub_no": "①",
            "item": "前端 PATCH /users/settings（default_stream_ttl）"
          },
          {
            "sub_no": "②",
            "item": "後端驗證區間（ge=300, le=21600），不符合則回 422/400"
          },
          {
            "sub_no": "③",
            "item": "寫入 users.settings.default_stream_ttl 並 commit"
          }
        ]
      },
      {
        "step_no": 2,
        "title": "後續套用",
        "sub_steps": [
          {
            "sub_no": "①",
            "item": "相機串流相關 API 取得使用者 TTL（get_user_stream_ttl）並用於串流連結有效時間"
          }
        ]
      }
    ],
    "OUTPUT": [
      {
        "step_no": 1,
        "title": "顯示結果",
        "sub_steps": [
          {
            "sub_no": "①",
            "item": "成功：顯示「應用程式設定已更新」"
          },
          {
            "sub_no": "②",
            "item": "失敗：顯示錯誤訊息"
          }
        ]
      }
    ]
  },
  "資料表": {
    "table_name": "users",
    "columns": [
      {
        "欄位": "settings",
        "中文": "使用者設定(JSON)",
        "型態": "JSONB",
        "長度": null,
        "空值": "是",
        "預設值": null,
        "備註": "users.settings.default_stream_ttl"
      }
    ]
  }
}
